package server.database.dao;

import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

import server.database.User;
import server.database.connection.DbConnector;

public class MySqlUserDao implements UserDao {

	DbConnector conn = new DbConnector();
	private PreparedStatement prStatement = null;
	private ResultSet result = null;
	
	private String getUser = "SELECT * FROM hotel.users WHERE users.id = ? ";

	@Override
	public User getUserById(int id) {
		try {
			prStatement = conn.getConnDB().prepareStatement(getUser);
			prStatement.setInt(1, id);
			result = prStatement.executeQuery();
			return resultToObject();
		} catch (SQLException e) {
			e.printStackTrace();
		}
		return null;
	}

	private User resultToObject () throws SQLException {
		User user = new User();
		while(result.next()) {
			user.setId(result.getInt("users.id"));
			user.setUsername(result.getString("users.username"));
			user.setPassword(result.getString("users.password"));
			user.setRole(result.getInt("users.role"));
		}
		return user;
	}
}
